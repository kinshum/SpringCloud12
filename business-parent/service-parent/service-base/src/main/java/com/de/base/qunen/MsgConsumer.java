package com.de.base.qunen;import com.de.JsonConvertUtils;import com.de.base.entity.SysDict;import com.de.base.entity.SysOperationLog;import com.de.base.entity.SysTemp;import com.de.base.mapper.SysDictMapper;import com.de.base.mapper.SysOperationLogMapper;import com.de.base.mapper.SysTempMapper;import com.de.util.IdWorker;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.kafka.annotation.KafkaListener;import org.springframework.stereotype.Component;import java.util.Random;/** * * @author jensen * @description  消息消费者 * @date 2018/5/3 5:31 * @param * @return */@Componentpublic class MsgConsumer {    @Autowired    private SysOperationLogMapper sysOperationLogMapper;    @Autowired    private SysTempMapper sysTempMapper;    @KafkaListener(topics = {"sysDict"})    public void processMessage(String sysOperationLog) {        IdWorker id = new IdWorker(1,0);        for (int i=0; i<100000; i++) {            SysTemp sysTemp = new SysTemp();            sysTemp.setId(id.nextId());            sysTemp.setName(String.valueOf(new Random(100).nextInt()));            sysTemp.setProvince("北京"+i);            sysTemp.setNameEn(i+"杭州");            sysTemp.setNamePy("南京"+i);            sysTemp.setWeathercnid(id.nextId());            sysTempMapper.insertSelective(sysTemp);        }    }}